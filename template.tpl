___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "__wm": "VGVtcGFsdGUtQXV0aG9yX0NvbnNlbnRNb2RlLVNpbW8tQWhhdmE\u003d",
  "version": 1,
  "securityGroups": [],
  "displayName": "Test Finsweet Consent Mode (Google tags)",
  "categories": [
    "UTILITY",
    "ANALYTICS",
    "ADVERTISING"
  ],
  "brand": {
    "id": "github.com_test-finsweet-templates-cookie-consent",
    "displayName": "test-finsweet-templates-cookie-consent",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Adjust tag behavior based on consent. This template utilizes Google\u0027s Consent API and can be used to adjust how Google\u0027s advertising and analytics tools use cookies and process ad identifiers.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "SELECT",
    "name": "command",
    "displayName": "Consent Command",
    "selectItems": [
      {
        "value": "default",
        "displayValue": "Default"
      },
      {
        "value": "update",
        "displayValue": "Update"
      }
    ],
    "simpleValueType": true,
    "help": "\u003cstrong\u003eDefault\u003c/strong\u003e means that you establish consent settings the site falls back on until such a time that the Update command is executed. You can have multiple Default tags on the page, each corresponding to a different region, for example.\n\u003cstrong\u003eUpdate\u003c/strong\u003e is what you\u0027d use once you\u0027ve retrieved a consent status from the user.",
    "defaultValue": "default",
    "alwaysInSummary": true
  },
  {
    "type": "TEXT",
    "name": "wait_for_update",
    "displayName": "Wait for Update",
    "simpleValueType": true,
    "valueUnit": "milliseconds",
    "defaultValue": 0,
    "help": "How long to wait (in milliseconds) for an \u003cstrong\u003eUpdate\u003c/strong\u003e command before firing Google tags that have been queued up.",
    "enablingConditions": [
      {
        "paramName": "command",
        "paramValue": "default",
        "type": "EQUALS"
      }
    ],
    "valueValidators": [
      {
        "type": "NON_NEGATIVE_NUMBER"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "regions",
    "displayName": "Regions",
    "simpleValueType": true,
    "defaultValue": "all",
    "help": "Apply this setting to users from these \u003ca href\u003d\"https://en.wikipedia.org/wiki/ISO_3166-2\"\u003eregions\u003c/a\u003e (provide a comma-separated list). If you type \u003cstrong\u003eall\u003c/strong\u003e, the setting will apply to all users. If you type \u003cstrong\u003eeea\u003c/strong\u003e as one of the regions, the tag will automatically include all European Economic Area regions as geographical targets for this command.",
    "enablingConditions": [],
    "valueValidators": [
      {
        "type": "NON_EMPTY",
        "errorMessage": "Set to \"all\" for all regions or add a comma-separated list of regions."
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "settings",
    "displayName": "Consent Settings",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "GROUP",
        "name": "required",
        "displayName": "Required for Google services",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "SELECT",
            "name": "ad_storage",
            "displayName": "ad_storage",
            "macrosInSelect": true,
            "selectItems": [
              {
                "value": "granted",
                "displayValue": "granted"
              },
              {
                "value": "denied",
                "displayValue": "denied"
              },
              {
                "value": "notset",
                "displayValue": "Not set"
              }
            ],
            "simpleValueType": true,
            "defaultValue": "denied",
            "help": "If set to \u003cstrong\u003edenied\u003c/strong\u003e, Google\u0027s advertising tags and pixels will not be able to read or write first-party cookies. The use of third-party cookies is limited to only spam and fraud detection purposes. \u003ca href\u003d\"https://support.google.com/analytics/answer/9976101#behavior\"\u003eMore information\u003c/a\u003e."
          },
          {
            "type": "SELECT",
            "name": "analytics_storage",
            "displayName": "analytics_storage",
            "macrosInSelect": true,
            "selectItems": [
              {
                "value": "granted",
                "displayValue": "granted"
              },
              {
                "value": "denied",
                "displayValue": "denied"
              },
              {
                "value": "notset",
                "displayValue": "Not set"
              }
            ],
            "simpleValueType": true,
            "defaultValue": "denied",
            "help": "If set to \u003cstrong\u003edenied\u003c/strong\u003e, Google Analytics tags will not read or write analytics cookies, and data collected to Google Analytics will not utilize persistent cookie identifiers (the identifiers are reset with every page load). \u003ca href\u003d\"https://support.google.com/analytics/answer/9976101#behavior\"\u003eMore information\u003c/a\u003e."
          },
          {
            "type": "SELECT",
            "name": "ad_user_data",
            "displayName": "ad_user_data",
            "macrosInSelect": true,
            "selectItems": [
              {
                "value": "granted",
                "displayValue": "granted"
              },
              {
                "value": "denied",
                "displayValue": "denied"
              },
              {
                "value": "notset",
                "displayValue": "Not set"
              }
            ],
            "simpleValueType": true,
            "defaultValue": "denied",
            "help": "If set to \u003cstrong\u003edenied\u003c/strong\u003e, user data cannot be used with Google\u0027s advertising solutions for audience building."
          },
          {
            "type": "SELECT",
            "name": "ad_personalization",
            "displayName": "ad_personalization",
            "macrosInSelect": true,
            "selectItems": [
              {
                "value": "granted",
                "displayValue": "granted"
              },
              {
                "value": "denied",
                "displayValue": "denied"
              },
              {
                "value": "notset",
                "displayValue": "Not set"
              }
            ],
            "simpleValueType": true,
            "defaultValue": "denied",
            "help": "If set to \u003cstrong\u003edenied\u003c/strong\u003e, data collected on this website will not be used for remarketing in Google\u0027s advertising solutions."
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "optional",
        "displayName": "Other signals",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "SELECT",
            "name": "personalization_storage",
            "displayName": "personalization_storage",
            "macrosInSelect": true,
            "selectItems": [
              {
                "value": "granted",
                "displayValue": "granted"
              },
              {
                "value": "denied",
                "displayValue": "denied"
              },
              {
                "value": "notset",
                "displayValue": "Not set"
              }
            ],
            "simpleValueType": true,
            "defaultValue": "denied"
          },
          {
            "type": "SELECT",
            "name": "functionality_storage",
            "displayName": "functionality_storage",
            "macrosInSelect": true,
            "selectItems": [
              {
                "value": "granted",
                "displayValue": "granted"
              },
              {
                "value": "denied",
                "displayValue": "denied"
              },
              {
                "value": "notset",
                "displayValue": "Not set"
              }
            ],
            "simpleValueType": true,
            "defaultValue": "denied"
          },
          {
            "type": "SELECT",
            "name": "security_storage",
            "displayName": "security_storage",
            "macrosInSelect": true,
            "selectItems": [
              {
                "value": "granted",
                "displayValue": "granted"
              },
              {
                "value": "denied",
                "displayValue": "denied"
              },
              {
                "value": "notset",
                "displayValue": "Not set"
              }
            ],
            "simpleValueType": true,
            "defaultValue": "granted"
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "other",
    "displayName": "Other Settings",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "url_passthrough",
        "checkboxText": "Pass Ad Click Information Through URLs (url_passthrough)",
        "simpleValueType": true,
        "help": "Check this if you want internal links to pass advertising identifiers (\u003cstrong\u003egclid\u003c/strong\u003e, \u003cstrong\u003edclid\u003c/strong\u003e, \u003cstrong\u003egclsrc\u003c/strong\u003e, \u003cstrong\u003e_gl\u003c/strong\u003e, \u003cstrong\u003ewbraid\u003c/strong\u003e) in the link URL while waiting for consent to be granted. \u003ca href\u003d\"https://developers.google.com/tag-platform/security/guides/consent#passthroughs\"\u003eRead more here\u003c/a\u003e."
      },
      {
        "type": "CHECKBOX",
        "name": "ads_data_redaction",
        "checkboxText": "Redact Ads Data (ads_data_redaction)",
        "simpleValueType": true,
        "help": "If this is checked \u003cstrong\u003eand\u003c/strong\u003e ad_storage consent status is \u003cstrong\u003edenied\u003c/strong\u003e, Google\u0027s advertising tags will drop all advertising identifiers from the requests, and traffic will be routed through cookieless domains."
      },
      {
        "type": "CHECKBOX",
        "name": "sendDataLayer",
        "checkboxText": "Push dataLayer Event",
        "simpleValueType": true,
        "help": "When consent is set to \"default\", a dataLayer event with \u003cstrong\u003eevent: \u0027gtm_consent_default\u0027\u003c/strong\u003e is sent, together with all the consent states. When an \"update\" is fired, a dataLayer event with \u003cstrong\u003eevent: \u0027gtm_consent_update\u0027\u003c/strong\u003e is pushed together with details about the updated consent state."
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const dataLayerPush = require('createQueue')('dataLayer');
const gtagSet = require('gtagSet');
const log = require('logToConsole');
const makeNumber = require('makeNumber');
const makeTableMap = require('makeTableMap');
const setDefaultConsentState = require('setDefaultConsentState');
const updateConsentState = require('updateConsentState');

const regions = data.regions;

// Determine the command and the setting object
const consentApi = data.command === 'default' ? setDefaultConsentState : updateConsentState;

const settingsObject = {};

if (data.ad_storage !== 'notset') settingsObject.ad_storage = data.ad_storage;
if (data.analytics_storage !== 'notset') settingsObject.analytics_storage = data.analytics_storage;
if (data.ad_user_data !== 'notset') settingsObject.ad_user_data = data.ad_user_data;
if (data.ad_personalization !== 'notset') settingsObject.ad_personalization = data.ad_personalization;
if (data.personalization_storage !== 'notset') settingsObject.personalization_storage = data.personalization_storage;
if (data.functionality_storage !== 'notset') settingsObject.functionality_storage = data.functionality_storage;
if (data.security_storage !== 'notset') settingsObject.security_storage = data.security_storage;

// Settings specific to the "default" command
if (data.command === 'default' && makeNumber(data.wait_for_update) > 0) {
  settingsObject.wait_for_update = makeNumber(data.wait_for_update);
}

// Set advanced settings
gtagSet({
  url_passthrough: data.url_passthrough || false,
  ads_data_redaction: data.ads_data_redaction || false,
});

// Set the consent state
consentApi(settingsObject);

// Push to dataLayer if needed
if (data.sendDataLayer) {
  settingsObject.event = 'gtm_consent_' + data.command;
  dataLayerPush(settingsObject);
}

// Call data.gtmOnSuccess when the tag is finished.
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "personalization_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "functionality_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "security_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_user_data"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_personalization"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "write_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "url_passthrough"
              },
              {
                "type": 1,
                "string": "ads_data_redaction"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: default settings sent
  code: |-
    // Call runCode to run the template's code.
    runCode(mockData);

    // Verify that the tag finished successfully.
    assertApi('setDefaultConsentState').wasCalledWith({
      analytics_storage: 'denied',
      ad_user_data: 'granted',
      ad_personalization: 'denied',
      personalization_storage: 'denied',
      functionality_storage: 'denied',
      security_storage: 'denied',
      wait_for_update: 500
    });

    assertApi('gtmOnSuccess').wasCalled();
- name: updated settings sent
  code: |-
    mockData.command = 'update';

    // Call runCode to run the template's code.
    runCode(mockData);

    // Verify that the tag finished successfully.
    assertApi('updateConsentState').wasCalledWith({
      analytics_storage: 'denied',
      ad_user_data: 'granted',
      ad_personalization: 'denied',
      personalization_storage: 'denied',
      functionality_storage: 'denied',
      security_storage: 'denied'
    });
    assertApi('gtmOnSuccess').wasCalled();
- name: extra settings sent
  code: |-
    mock('gtagSet', (obj) => {
      assertThat(obj.url_passthrough).isEqualTo(true);
      assertThat(obj.ads_data_redaction).isEqualTo(true);
    });
    // Call runCode to run the template's code.
    runCode(mockData);

    // Verify that the tag finished successfully.
    assertApi('gtmOnSuccess').wasCalled();
- name: dataLayer events generated
  code: "mockData.sendDataLayer = true;\n\nlet dlCalled = false;\n\nmock('createQueue',\
    \ name => {\n  return o => {\n    if (o.event === 'gtm_consent_default' && \n\
    \        o.analytics_storage === 'denied' && \n        o.ad_user_data === 'granted'\
    \ &&\n        o.ad_personalization === 'denied' &&\n        o.personalization_storage\
    \ === 'denied' &&\n        o.functionality_storage === 'denied' &&\n        o.security_storage\
    \ === 'denied') dlCalled = true;\n    \n  };\n});\n    \n// Call runCode to run\
    \ the template's code.\nrunCode(mockData);\n\n// Verify that the tag finished\
    \ successfully.\nassertApi('gtmOnSuccess').wasCalled();\nassertThat(dlCalled,\
    \ 'dataLayer not called with correct arguments').isEqualTo(true);"
setup: |-
  const mockData = {
    command: 'default',
    ad_storage: 'notset',
    analytics_storage: 'denied',
    ad_user_data: 'granted',
    ad_personalization: 'denied',
    personalization_storage: 'denied',
    functionality_storage: 'denied',
    security_storage: 'denied',
    wait_for_update: 500,
    regions: 'US-CA',
    url_passthrough: true,
    ads_data_redaction: true,
    sendDataLayer: false,
  };


___NOTES___

Created on 07/10/2020, 10:39:35


